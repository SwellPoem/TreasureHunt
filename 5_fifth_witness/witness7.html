<html>
<head>
  <title>Witness</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script type="text/javascript" src="./engine/utilities.js"></script>
  <script type="text/javascript" src="./engine/svg.js"></script>
  <script async type="text/javascript" src="./engine/polyominos.js"></script>
  <script async type="text/javascript" src="./engine/puzzle.js"></script>
  <script async type="text/javascript" src="./engine/validate.js"></script>
  <script async type="text/javascript" src="./engine/custom_mechanics.js"></script>
  <script async type="text/javascript" src="./engine/display2.js"></script>
  <script async type="text/javascript" src="./engine/trace2.js"></script>
  <script async type="text/javascript" src="onLoadScripts.js"></script>
  <script>
    function loadPuzzle() {
      var puzzle = Puzzle.deserialize(" {\"grid\":[[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"start\":null,\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\",\"end\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\",\"start\":true}],[{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"right\"},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"line\":2,\"dir\":null,\"end\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":2,\"dir\":\"left\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":2,\"dir\":\"top\"},{\"type\":\"line\",\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null,\"start\":null,\"end\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"end\":\"top\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"start\":true,\"line\":3,\"dir\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"nonce\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"start\":null,\"line\":0,\"dir\":null}],[{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null,\"gap\":1,\"dot\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"line\":3,\"dir\":null},{\"type\":\"line\",\"end\":null,\"start\":null,\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"line\":0,\"dir\":null},{\"type\":\"line\",\"start\":null,\"line\":0,\"dir\":null}]],\"largezero\":374,\"width\":11,\"height\":17,\"pillar\":false,\"settings\":{\"NEGATIONS_CANCEL_NEGATIONS\":true,\"SHAPELESS_ZERO_POLY\":false,\"PRECISE_POLYOMINOS\":true,\"FLASH_FOR_ERRORS\":true,\"FAT_STARTPOINTS\":false,\"CUSTOM_MECHANICS\":false},\"symmetry\":{\"x\":true,\"y\":false},\"name\":\"Unnamed Horizontal Symmetry Puzzle\",\"hasNegations\":false,\"hasPolyominos\":false,\"startPoint\":{\"x\":2,\"y\":16},\"endPoint\":{\"x\":6,\"y\":0},\"autoSolved\":true,\"path\":[{\"x\":2,\"y\":16},3,3,3,3,2,2,3,3,1,1,3,3,1,1,3,3,2,2,2,2,3,3,1,1,3,3,2,2,3,3,0]}\n")
      draw(puzzle)
    }
  </script>
</head>
<body>
  <script>loadHeader("Lunar Cycle I")</script>
  <div style="display: flex; justify-content: center; align-items: center">
    <svg id="puzzle" style="pointer-events: auto"></svg>
  </div>
</body>
<script type="module">
  
  import { resizePuzzle } from './onLoadScripts.js';
  
  var onLoadFunctions = [];
  
  function addOnLoad(funcName) {
    onLoadFunctions[onLoadFunctions.length] = funcName;
  }
  
  function executeOnLoad() {
    for (var i=0; i<onLoadFunctions.length; i++) onLoadFunctions[i]();
  }
  
  addOnLoad(loadPuzzle);
  addOnLoad(resizePuzzle);
  
  window.onload = executeOnLoad;
  
  var keys = {37: 1, 38: 1, 39: 1, 40: 1};
  
  function preventDefault(e) {
    e.preventDefault();
  }
  
  function preventDefaultForScrollKeys(e) {
    if (keys[e.keyCode]) {
      preventDefault(e);
      return false;
    }
  }
  
  // modern Chrome requires { passive: false } when adding event
  var supportsPassive = false;
  try {
    window.addEventListener("test", null, Object.defineProperty({}, 'passive', {
      get: function () { supportsPassive = true; } 
    }));
  } catch(e) {}
  
  var wheelOpt = supportsPassive ? { passive: false } : false;
  var wheelEvent = 'onwheel' in document.createElement('div') ? 'wheel' : 'mousewheel';
  
  // call this to Disable
  function disableScroll() {
    window.addEventListener('DOMMouseScroll', preventDefault, false); // older FF
    window.addEventListener(wheelEvent, preventDefault, wheelOpt); // modern desktop
    window.addEventListener('touchmove', preventDefault, wheelOpt); // mobile
    window.addEventListener('keydown', preventDefaultForScrollKeys, false);
  }
  
  // call this to Enable
  function enableScroll() {
    window.removeEventListener('DOMMouseScroll', preventDefault, false);
    window.removeEventListener(wheelEvent, preventDefault, wheelOpt); 
    window.removeEventListener('touchmove', preventDefault, wheelOpt);
    window.removeEventListener('keydown', preventDefaultForScrollKeys, false);
  }
  
  disableScroll();
  
</script>
</html>